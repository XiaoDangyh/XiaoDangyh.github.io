{"title":"MSP432 Stepper motor","slug":"MSP432-Stepper-motor","date":"2021-08-26T03:46:28.000Z","updated":"2021-09-03T14:15:21.843Z","comments":true,"path":"api/articles/MSP432-Stepper-motor.json","photos":[],"link":"","excerpt":"MSP432P401步进电机使用","covers":["https://img-blog.csdnimg.cn/5347cbcec353429b8937443e2ef868c4.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2F6czA1MDQ=,size_16,color_FFFFFF,t_70","https://img-blog.csdnimg.cn/c252fe9594cf4874acc0f2db74c987cd.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2F6czA1MDQ=,size_16,color_FFFFFF,t_70","https://img-blog.csdnimg.cn/397e0996b7e94094950e1ee8392deb4a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2F6czA1MDQ=,size_16,color_FFFFFF,t_70"],"content":"<p>MSP432P401步进电机使用</p>\n<iframe frameborder=\"no\" border=\"0\" marginwidth=\"0\" marginheight=\"0\" width=330 height=86 src=\"//music.163.com/outchain/player?type=2&id=1804888684&auto=1&height=66\"></iframe>\n\n<span id=\"more\"></span>\n\n<p>其实是电赛练手题里有一个1分钟转一圈的要求，就算我把占空比改到最小，也无法办到，证明普通电机无法办到这一点，只好用到步进电机。同时我们还要一个步进电机驱动，就是之后图片的大黑盒子DM542，大概100大洋左右。</p>\n<p><img src=\"https://img-blog.csdnimg.cn/5347cbcec353429b8937443e2ef868c4.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2F6czA1MDQ=,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\"></p>\n<p>代码部分</p>\n<p><code>设置TIMER_A输出pwm</code></p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Timer_A_PWMConfig TIM0_PwmConfig2 =</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">                TIMER_A_CLOCKSOURCE_SMCLK,</span><br><span class=\"line\">                TIMER_A_CLOCKSOURCE_DIVIDER_16,</span><br><span class=\"line\">                <span class=\"number\">7000</span>,</span><br><span class=\"line\">                TIMER_A_CAPTURECOMPARE_REGISTER_2,</span><br><span class=\"line\">                TIMER_A_OUTPUTMODE_RESET_SET,</span><br><span class=\"line\">                <span class=\"number\">3750</span>,</span><br><span class=\"line\">        &#125;;</span><br></pre></td></tr></table></figure>\n\n\n<p>分析：细分数<code>可以细分1/2/4/8/16/32，即每给一个脉冲转过角度（1.8/细分数）</code><br><code>如果要转360°，就要360/（1.8/细分数）,假设细分数为32，就要给6400个脉冲转一圈，而一圈对应60s</code></p>\n<p><code>时钟频12000000（在源程序中时钟源设置为12000000）/16（TIMER_A_CLOCKSOURCE_DIVIDER_16）/7500（之后会改）=100HZ</code><br><code>即0.01s内给一次脉冲，（6000个0.01s为1分钟）但实际上在这一分钟内给的是6400/6000=1.067个脉冲，修正后psc给7000比较合适，相当于缩短了周期6400/7000=0.91个脉冲</code></p>\n<figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">电机初始化</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">TimerA0_Init</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">       <span class=\"built_in\">MAP_GPIO_setAsPeripheralModuleFunctionOutputPin</span>(GPIO_PORT_P2,GPIO_PIN4,GPIO_PRIMARY_MODULE_FUNCTION);</span><br><span class=\"line\">       <span class=\"built_in\">MAP_GPIO_setAsPeripheralModuleFunctionOutputPin</span>(GPIO_PORT_P2,GPIO_PIN5,GPIO_PRIMARY_MODULE_FUNCTION);</span><br><span class=\"line\">       <span class=\"built_in\">Timer_A_generatePWM</span>(TIMER_A0_BASE, &amp;TIM0_PwmConfig1);</span><br><span class=\"line\">       <span class=\"built_in\">Timer_A_generatePWM</span>(TIMER_A0_BASE, &amp;TIM0_PwmConfig2);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">直接角度输入</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">set_Angle</span><span class=\"params\">(<span class=\"type\">float</span> angle)</span>`<span class=\"comment\">//这里我转化成角度来测试</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">delay_us</span>(angle*<span class=\"number\">4000</span>);</span><br><span class=\"line\">    <span class=\"built_in\">MAP_GPIO_setAsOutputPin</span>(GPIO_PORT_P2, GPIO_PIN5);</span><br><span class=\"line\">    <span class=\"built_in\">MAP_GPIO_setOutputLowOnPin</span>(GPIO_PORT_P2, GPIO_PIN5);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">主程序</span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tWDT_A-&gt;CTL = WDT_A_CTL_PW | WDT_A_CTL_HOLD;\t\t<span class=\"comment\">// stop watchdog timer</span></span><br><span class=\"line\">    <span class=\"built_in\">TimerA0_Init</span>();</span><br><span class=\"line\"><span class=\"comment\">//    set_Angle(90);</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span>(<span class=\"number\">1</span>)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>垃圾接线大家勉强看一下</p>\n<p><img src=\"https://img-blog.csdnimg.cn/c252fe9594cf4874acc0f2db74c987cd.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2F6czA1MDQ=,size_16,color_FFFFFF,t_70\" alt=\"img\"></p>\n<p>EN+和-以及PUL-DIR-全部接地（共阴接法）</p>\n<p>PUL+接pwm DIR+默认3.3V</p>\n<p>A+A-接步进电机最左最右，B+B-接中间两个</p>\n<p>VCC（接电源9-42V)，咨询学长后知道，如果要转高速的话电压和电流也要增大，GND接电源GND</p>\n<p>SW设置</p>\n<p><img src=\"https://img-blog.csdnimg.cn/397e0996b7e94094950e1ee8392deb4a.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2F6czA1MDQ=,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\"></p>\n","categories":[{"name":"基本功能食用","slug":"基本功能食用","count":10,"path":"api/categories/基本功能食用.json"}],"tags":[{"name":"MSP432","slug":"MSP432","count":1,"path":"api/tags/MSP432.json"},{"name":"电机外设","slug":"电机外设","count":1,"path":"api/tags/电机外设.json"},{"name":"电赛准备","slug":"电赛准备","count":1,"path":"api/tags/电赛准备.json"}]}